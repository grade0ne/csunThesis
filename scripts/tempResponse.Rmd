---
title: "Rotifer response to temperature"
author: "Alex Mendelson"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(ggplot2)
```

## Data import and factoring

```{r dataImport, include = TRUE}
data <- read.csv("../data/tempRes2.csv")

data$cloneID <- paste(data$Site, data$Leaf, data$Clone, sep="-")

data$Site <- as.factor(data$Site)
data$Leaf <- as.factor(data$Leaf)
data$Treatment <- as.factor(data$Treatment)
data$Clone <- as.factor(data$Clone)
data$cloneID <- as.factor(data$cloneID)
```

## Growth curves

```{r growthCurveData, echo = FALSE}
cloneAvg <- data %>%
  group_by(Day, Treatment, Site, cloneID) %>%
  summarise(
    avgCount = mean(Count),
    SE = sd(Count) / sqrt(n())
  )
```

```{r growthCurveCombined}
# avg counts all clones one plot

ggplot(cloneAvg, aes(x = Day, y = avgCount, color = Treatment, group = interaction(cloneID, Treatment, Site))) +
  geom_point() +
  geom_line() +
  labs(y = "Rotifer Abundance", x = "Day", caption = "Figure 1. Average counts over time in 2 temps, pooled clones") +
  scale_x_continuous(breaks = seq(3, 21, by = 3)) +
  theme_minimal() +
  theme(
    panel.grid = element_blank(),            
    panel.border = element_rect(color = "black", fill = NA, linewidth = 0.8),  
    strip.background = element_rect(fill = "gray90", color = NA), 
    plot.caption = element_text(hjust = 0)  
  )
```

```{r growthCurveIndiv}
# avg counts (+/- SE) over time in 2 temps (color) wrapped by cloneID

ggplot(cloneAvg, aes(x = Day, y = avgCount, color = Treatment, group = interaction(cloneID, Treatment, Site))) +
  geom_point() +
  geom_line() +
  labs(y = "Rotifer Abundance", x = "Day", caption = "Figure 2. Average counts (+/- SE) over time in 2 temps (color) wrapped by cloneID") +
  scale_x_continuous(breaks = seq(3, 21, by = 3)) +
  geom_errorbar(aes(ymin = avgCount - SE, ymax = avgCount + SE), width = 0.2, alpha = 0.6) +
  theme_minimal() +
  facet_wrap(~cloneID) +
  theme(
    panel.grid = element_blank(),            
    panel.border = element_rect(color = "black", fill = NA, linewidth = 0.8),  
    strip.background = element_rect(fill = "gray90", color = NA), 
    plot.caption = element_text(hjust = 0)  
  )

```

## Growth rates

```{r grothRatesData}



```